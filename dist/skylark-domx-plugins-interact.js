/**
 * skylark-domx-plugins-interact - The interact features enhancement for dom.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
!function(r,a){var e=a.define,require=a.require,n="function"==typeof e&&e.amd,t=!n&&"undefined"!=typeof exports;if(!n&&!e){var g={};e=a.define=function(r,a,e){"function"==typeof e?(g[r]={factory:e,deps:a.map(function(a){return function(r,a){if("."!==r[0])return r;var e=a.split("/"),n=r.split("/");e.pop();for(var t=0;t<n.length;t++)"."!=n[t]&&(".."==n[t]?e.pop():e.push(n[t]));return e.join("/")}(a,r)}),resolved:!1,exports:null},require(r)):g[r]={factory:null,resolved:!0,exports:e}},require=a.require=function(r){if(!g.hasOwnProperty(r))throw new Error("Module "+r+" has not been defined");var module=g[r];if(!module.resolved){var e=[];module.deps.forEach(function(r){e.push(require(r))}),module.exports=module.factory.apply(a,e)||null,module.resolved=!0}return module.exports}}if(!e)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(r,require){r("skylark-domx-plugins-interact/dnd",["skylark-langx/skylark"],function(r){return r.attach("domx.plugins.dnd",{})}),r("skylark-domx-plugins-interact/manager",["./dnd","skylark-langx/langx","skylark-domx-noder","skylark-domx-data","skylark-domx-finder","skylark-domx-geom","skylark-domx-eventer","skylark-domx-styler"],function(r,a,e,n,t,g,s,o){s.on,s.off,n.attr,n.removeAttr,g.pagePosition,o.addClass,g.height;var d=r.Manager=a.Evented.inherit({klassName:"Manager",init:function(){},prepare:function(r){var a=s.create("preparing",{dragSource:r.dragSource,dragHandle:r.dragHandle});r.trigger(a),r.dragSource=a.dragSource},start:function(r,e){var n=g.pagePosition(r.dragSource);this.draggingOffsetX=parseInt(e.pageX-n.left),this.draggingOffsetY=parseInt(e.pageY-n.top);var t=s.create("started",{elm:r.elm,dragSource:r.dragSource,dragHandle:r.dragHandle,ghost:null,transfer:{}});r.trigger(t),this.dragging=r,r.draggingClass&&o.addClass(r.dragSource,r.draggingClass),this.draggingGhost=t.ghost,this.draggingGhost||(this.draggingGhost=r.elm),this.draggingTransfer=t.transfer,this.draggingTransfer&&a.each(this.draggingTransfer,function(r,a){e.dataTransfer.setData(r,a)}),e.dataTransfer.setDragImage(this.draggingGhost,this.draggingOffsetX,this.draggingOffsetY),e.dataTransfer.effectAllowed="copyMove";var d=s.create("dndStarted",{elm:t.elm,dragSource:t.dragSource,dragHandle:t.dragHandle,ghost:t.ghost,transfer:t.transfer});this.trigger(d)},over:function(){},end:function(r){var a=this.dragging;a&&a.draggingClass&&o.removeClass(a.dragSource,a.draggingClass);var e=s.create("dndEnded",{});this.trigger(e),this.dragging=null,this.draggingTransfer=null,this.draggingGhost=null,this.draggingOffsetX=null,this.draggingOffsetY=null}}),i=new d;return i}),r("skylark-domx-plugins-interact/Draggable",["skylark-langx/langx","skylark-domx-noder","skylark-domx-data","skylark-domx-finder","skylark-domx-geom","skylark-domx-eventer","skylark-domx-styler","skylark-domx-plugins-base","./dnd","./manager"],function(r,a,e,n,t,g,s,o,d,i){g.on,g.off,e.attr,e.removeAttr,t.pagePosition,s.addClass,t.height;var l=o.Plugin.inherit({klassName:"Draggable",pluginName:"lark.draggable",options:{draggingClass:"dragging"},_construct:function(a,t){this.overrided(a,t);var s=this,t=this.options;s.draggingClass=t.draggingClass,["preparing","started","ended","moving"].forEach(function(a){r.isFunction(t[a])&&s.on(a,t[a])}),g.on(a,{mousedown:function(r){var a=s.options;a.handle&&(s.dragHandle=n.closest(r.target,a.handle),!s.dragHandle)||(a.source?s.dragSource=n.closest(r.target,a.source):s.dragSource=s._elm,i.prepare(s),s.dragSource&&e.attr(s.dragSource,"draggable","true"))},mouseup:function(r){s.dragSource&&(s.dragSource=null,s.dragHandle=null)},dragstart:function(r){e.attr(s.dragSource,"draggable","false"),i.start(s,r)},dragend:function(r){g.stop(r),i.dragging&&i.end(!1)}})}});return o.register(l,"draggable"),d.Draggable=l}),r("skylark-domx-plugins-interact/Droppable",["skylark-langx/langx","skylark-domx-noder","skylark-domx-data","skylark-domx-finder","skylark-domx-geom","skylark-domx-eventer","skylark-domx-styler","skylark-domx-plugins-base","./dnd","./manager"],function(r,a,e,n,t,g,s,o,d,i){g.on,g.off,e.attr,e.removeAttr,t.pagePosition,s.addClass,t.height;var l=o.Plugin.inherit({klassName:"Droppable",pluginName:"lark.droppable",options:{draggingClass:"dragging"},_construct:function(a,e){this.overrided(a,e);var n,t,o=this,e=o.options,d=(e.draggingClass,!0);["started","entered","leaved","dropped","overing"].forEach(function(a){r.isFunction(e[a])&&o.on(a,e[a])}),g.on(a,{dragover:function(r){if(r.stopPropagation(),d){var a=g.create("overing",{overElm:r.target,transfer:i.draggingTransfer,acceptable:!0});o.trigger(a),a.acceptable&&(r.preventDefault(),r.dataTransfer.dropEffect="copyMove")}},dragenter:function(r){o.options;var a=o._elm,e=g.create("entered",{transfer:i.draggingTransfer});o.trigger(e),r.stopPropagation(),n&&d&&s.addClass(a,n)},dragleave:function(r){o.options;var a=o._elm;if(!d)return!1;var e=g.create("leaved",{transfer:i.draggingTransfer});o.trigger(e),r.stopPropagation(),n&&d&&s.removeClass(a,n)},drop:function(r){o.options;var a=o._elm;if(g.stop(r),i.dragging){n&&d&&s.addClass(a,n);var e=g.create("dropped",{transfer:i.draggingTransfer});o.trigger(e),i.end(!0)}}}),i.on("dndStarted",function(r){var e=g.create("started",{transfer:i.draggingTransfer,acceptable:!1});o.trigger(e),d=e.acceptable,n=e.hoverClass,(t=e.activeClass)&&d&&s.addClass(a,t)}).on("dndEnded",function(r){var e=g.create("ended",{transfer:i.draggingTransfer,acceptable:!1});o.trigger(e),n&&d&&s.removeClass(a,n),t&&d&&s.removeClass(a,t),d=!1,t=null,n=null})}});return o.register(l,"droppable"),d.Droppable=l}),r("skylark-domx-plugins-interact/main",["./dnd","./Draggable","./Droppable"],function(r){return r}),r("skylark-domx-plugins-interact",["skylark-domx-plugins-interact/main"],function(r){return r})}(e),!n){var s=require("skylark-langx-ns");t?module.exports=s:a.skylarkjs=s}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-domx-plugins-interact.js.map
